<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Aervo ‚Äì Dashboard</title>
  <link rel="icon" type="image/png" href="favicon.png">

  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #050817;
      color: #d6def8;
    }

    /* Top nav */
    .nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 56px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      background: rgba(5, 8, 23, 0.96);
      backdrop-filter: blur(14px);
      z-index: 20;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .nav-left {
      display: flex;
      flex-direction: column;
    }

    .nav-brand {
      font-weight: 600;
      letter-spacing: 4px;
      font-size: 14px;
      color: #8fbfff;
    }

    .nav-sub {
      font-size: 11px;
      color: #9ca7d6;
    }

    .nav-center {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }

    .nav-logo {
      width: 38px;
      opacity: 0.95;
      filter: drop-shadow(0 0 10px rgba(137,180,255,0.8))
              drop-shadow(0 0 20px rgba(80,130,255,0.6));
    }

    .nav-right {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .nav-user-email {
      font-size: 11px;
      color: #9ca7d6;
    }

    .nav-right button {
      padding: 6px 14px;
      border-radius: 999px;
      border: 1px solid #3a4a7c;
      background: transparent;
      color: #dfe7ff;
      font-size: 12px;
      cursor: pointer;
    }

    .nav-right button:hover {
      background: #1a2237;
    }

    /* Layout with sidebar */
    .layout {
      display: flex;
      min-height: 100vh;
      padding-top: 56px; /* space for nav */
    }

    .sidebar {
      width: 220px;
      padding: 18px 14px 20px;
      border-right: 1px solid rgba(255,255,255,0.06);
      background: radial-gradient(circle at top left, #121628, #050817);
      box-shadow: 8px 0 30px rgba(0,0,0,0.5);
    }

    .sidebar-title {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #7f8ab8;
      margin-bottom: 10px;
    }

    .nav-section {
      margin-bottom: 20px;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 10px;
      border-radius: 10px;
      font-size: 13px;
      color: #b3c0f0;
      cursor: pointer;
      margin-bottom: 4px;
      border: 1px solid transparent;
    }

    .nav-item span.icon {
      font-size: 15px;
      opacity: 0.9;
    }

    .nav-item.active {
      background: #151a2a;
      border-color: rgba(143,191,255,0.4);
      box-shadow:
        0 0 10px rgba(137,180,255,0.4),
        0 0 20px rgba(40,90,255,0.4);
      color: #e5ecff;
    }

    .nav-item:hover:not(.active) {
      background: rgba(255,255,255,0.03);
    }

    .sidebar-footer {
      margin-top: 30px;
      font-size: 11px;
      color: #67709d;
    }

    /* Main area */
    .main {
      flex: 1;
      padding: 24px 28px 40px;
      max-width: 1100px;
      margin: 0 auto;
    }

    .page-title {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 12px;
      align-items: baseline;
      margin-bottom: 24px;
    }

    .page-title h1 {
      margin: 0;
      font-size: 24px;
      color: #e5ecff;
    }

    .page-title span {
      font-size: 13px;
      color: #9ca7d6;
    }

    /* Generic cards */
    .grid-3 {
      display: grid;
      gap: 16px;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      margin-bottom: 24px;
    }

    .grid-2 {
      display: grid;
      gap: 16px;
      grid-template-columns: minmax(0, 1.5fr) minmax(0, 1fr);
      margin-bottom: 24px;
    }

    .card {
      background: radial-gradient(circle at top left, #202642, #050817);
      border-radius: 14px;
      padding: 16px 16px 14px;
      border: 1px solid rgba(255,255,255,0.05);
      box-shadow: 0 16px 36px rgba(0,0,0,0.6);
    }

    .card h2 {
      margin: 0 0 4px;
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #9ca7d6;
    }

    .card .value {
      font-size: 22px;
      margin: 4px 0;
      color: #e5ecff;
    }

    .card .subtext {
      font-size: 12px;
      color: #8b94c0;
    }

    /* Ask Aervo card */
    .chat-card textarea {
      width: 100%;
      min-height: 80px;
      resize: vertical;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid #323a5c;
      background: #050817;
      color: #e5ecff;
      font-size: 14px;
      box-sizing: border-box;
    }

    .chat-card textarea:focus {
      outline: none;
      border-color: #6e9bff;
      box-shadow: 0 0 0 1px rgba(110,155,255,0.5);
    }

    .chat-card button {
      margin-top: 10px;
      padding: 8px 16px;
      border-radius: 999px;
      border: none;
      background: #1a243d;
      color: #b4cdff;
      font-size: 14px;
      cursor: pointer;
      box-shadow:
        0 0 10px rgba(137,180,255,0.4),
        0 0 24px rgba(80,130,255,0.3);
    }

    .chat-card button:hover {
      background: #222c48;
    }

    .chat-output {
      margin-top: 10px;
      font-size: 13px;
      color: #c5cff6;
      border-top: 1px solid rgba(255,255,255,0.06);
      padding-top: 8px;
      min-height: 40px;
      white-space: pre-line;
    }

    /* Lists */
    .list-card ul {
      list-style: none;
      padding: 0;
      margin: 8px 0 0;
      font-size: 13px;
      color: #c2cff6;
    }

    .list-card li {
      margin-bottom: 6px;
    }

    /* Products / customers tables */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      font-size: 13px;
    }

    th, td {
      padding: 6px 4px;
      text-align: left;
    }

    th {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #9ca7d6;
      border-bottom: 1px solid rgba(255,255,255,0.08);
    }

    tr + tr td {
      border-top: 1px solid rgba(255,255,255,0.04);
    }

    .pill {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
    }

    .pill-good {
      background: rgba(52, 211, 153, 0.14);
      color: #6ee7b7;
    }

    .pill-warn {
      background: rgba(251,191,36,0.12);
      color: #facc15;
    }

    .pill-bad {
      background: rgba(248,113,113,0.14);
      color: #fecaca;
    }

    /* Simple fake dark chart */
    .chart {
      margin-top: 10px;
      background: radial-gradient(circle at top, #192238, #050817);
      border-radius: 12px;
      padding: 14px 12px 16px;
      border: 1px solid rgba(255,255,255,0.04);
    }

    .chart-bars {
      display: flex;
      align-items: flex-end;
      gap: 10px;
      height: 120px;
      margin-bottom: 10px;
    }

    .chart-bar {
      flex: 1;
      border-radius: 6px 6px 2px 2px;
      background: linear-gradient(to top, #3045ff, #7ea8ff);
      box-shadow: 0 0 12px rgba(80,130,255,0.7);
      position: relative;
    }

    .chart-bar span {
      position: absolute;
      bottom: 4px;
      left: 4px;
      font-size: 10px;
      color: rgba(255,255,255,0.85);
    }

    .chart-labels {
      display: flex;
      justify-content: space-between;
      font-size: 10px;
      color: #8b94c0;
      padding: 0 2px;
    }

    /* Compare module */
    .compare-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
      margin-top: 10px;
    }

    .compare-box {
      background: rgba(15,21,39,0.9);
      border-radius: 10px;
      padding: 10px 12px;
      border: 1px solid rgba(255,255,255,0.06);
    }

    .compare-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #9ca7d6;
    }

    .compare-value {
      font-size: 18px;
      margin-top: 4px;
    }

    .compare-delta {
      font-size: 12px;
      color: #6ee7b7;
    }

    /* Notifications */
    .notification {
      padding: 8px 10px;
      border-radius: 10px;
      background: rgba(15,21,39,0.9);
      border: 1px solid rgba(255,255,255,0.05);
      font-size: 13px;
      margin-bottom: 8px;
    }

    .notification small {
      display: block;
      font-size: 11px;
      color: #8b94c0;
      margin-top: 2px;
    }

    /* Page sections (tabs) */
    .page-section {
      display: none;
    }

    .page-section.active {
      display: block;
    }

    /* Love footer */
    .love-footer {
      margin-top: 40px;
      padding: 22px 0;
      text-align: center;
      font-size: 15px;
      letter-spacing: 0.5px;
      color: #b4cdff;
      font-weight: 500;
      opacity: 0.95;
      text-shadow:
        0 0 6px rgba(137, 180, 255, 0.6),
        0 0 14px rgba(80, 130, 255, 0.4),
        0 0 26px rgba(40, 90, 255, 0.35);
    }

    @media (max-width: 900px) {
      .layout {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        display: flex;
        overflow-x: auto;
        padding: 10px 12px;
        border-right: none;
        border-bottom: 1px solid rgba(255,255,255,0.06);
      }

      .nav-section {
        display: flex;
        gap: 6px;
        margin-right: 16px;
        margin-bottom: 0;
      }

      .sidebar-title,
      .sidebar-footer {
        display: none;
      }

      .nav-item {
        white-space: nowrap;
      }

      .main {
        padding: 18px 16px 32px;
      }

      .grid-3 {
        grid-template-columns: 1fr;
      }

      .grid-2 {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>

  <!-- TOP NAV -->
  <header class="nav">
    <div class="nav-left">
      <div class="nav-brand">AERVO</div>
      <div class="nav-sub" id="companyLabel">Loading company‚Ä¶</div>
    </div>

    <div class="nav-center">
      <img src="logo.png" class="nav-logo" alt="Aervo Logo">
    </div>

    <div class="nav-right">
      <span class="nav-user-email" id="userEmail"></span>
      <button id="logoutBtn">Logout</button>
    </div>
  </header>

  <!-- Backend Status -->
  <div id="backend-status" 
  style="
    display:none;
    padding: 10px;
    background: #ffffff10;
    border: 1px solid #ffffff30;
    border-radius: 6px;
    margin: 80px 20px 10px 20px;
    font-weight: bold;
    color: #d6def8;">
    Checking backend‚Ä¶

  </div>

  <div class="layout">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="nav-section">
        <div class="sidebar-title">Overview</div>
        <div class="nav-item active" data-section="overview">
          <span class="icon">üìä</span>
          <span>Overview</span>
        </div>
      </div>

      <div class="nav-section">
        <div class="sidebar-title">Deep dive</div>
        <div class="nav-item" data-section="products">
          <span class="icon">üì¶</span>
          <span>Products</span>
        </div>
        <div class="nav-item" data-section="trends">
          <span class="icon">üìà</span>
          <span>Trends</span>
        </div>
        <div class="nav-item" data-section="customers">
          <span class="icon">üë•</span>
          <span>Customers</span>
        </div>
        <div class="nav-item" data-section="compare">
          <span class="icon">‚öñÔ∏è</span>
          <span>Compare periods</span>
        </div>
        <div class="nav-item" data-section="notifications">
          <span class="icon">üîî</span>
          <span>Notifications</span>
        </div>
      </div>

      <div class="sidebar-footer">
        Early Aervo demo ¬∑ Not real production data.
      </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="main">
      <!-- OVERVIEW SECTION -->
      <section id="section-overview" class="page-section active">
        <div class="page-title">
          <h1 id="welcomeTitle">Welcome back</h1>
          <span id="dateLabel"></span>
        </div>

        <div class="grid-3">
          <div class="card">
            <h2>Today‚Äôs revenue</h2>
            <div class="value" id="todayRevenue">$0</div>
            <div class="subtext" id="todayChange">‚Äì</div>
          </div>
          <div class="card">
            <h2>This week</h2>
            <div class="value" id="weekRevenue">$0</div>
            <div class="subtext" id="weekChange">‚Äì</div>
          </div>
          <div class="card">
            <h2>Top product</h2>
            <div class="value" id="topProduct">‚Äì</div>
            <div class="subtext" id="topProductDetail">‚Äì</div>
          </div>
        </div>

        <div class="grid-2">
          <div class="card chat-card">
            <h2>Ask Aervo</h2>
            <p class="subtext">This is a placeholder for your future AervoGPT. For now it gives a sample answer based on your demo data.</p>
            <textarea id="questionInput" placeholder="Example: How did we do today compared to yesterday?"></textarea>
            <button id="askBtn">Ask</button>
            <div class="chat-output" id="chatOutput"></div>
          </div>

          <div class="card list-card">
            <h2>Quick insights</h2>
            <ul id="insightsList"></ul>
          </div>
        </div>
      </section>

      <!-- PRODUCTS SECTION -->
      <section id="section-products" class="page-section">
        <div class="page-title">
          <h1>Products</h1>
          <span id="productsSubtitle">Top movers and low-stock alerts.</span>
        </div>

        <div class="grid-2">
          <div class="card">
            <h2>Top products (last 7 days)</h2>
            <table id="productsTable">
              <thead>
                <tr>
                  <th>Product</th>
                  <th>Units</th>
                  <th>Revenue</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                <!-- Filled by JS -->
              </tbody>
            </table>
          </div>

          <div class="card list-card">
            <h2>Inventory notes</h2>
            <ul id="inventoryNotes"></ul>
          </div>
        </div>
      </section>

      <!-- TRENDS SECTION -->
      <section id="section-trends" class="page-section">
        <div class="page-title">
          <h1>Trends</h1>
          <span id="trendsSubtitle">Simple view of recent performance.</span>
        </div>

        <div class="grid-2">
          <div class="card">
            <h2>Revenue by day</h2>
            <p class="subtext" id="trendSummary"></p>
            <div class="chart">
              <div class="chart-bars" id="chartBars">
                <!-- Bars filled by JS -->
              </div>
              <div class="chart-labels" id="chartLabels">
                <!-- Labels filled by JS -->
              </div>
            </div>
          </div>

          <div class="card list-card">
            <h2>Pattern highlights</h2>
            <ul id="trendHighlights"></ul>
          </div>
        </div>
      </section>

      <!-- CUSTOMERS SECTION -->
      <section id="section-customers" class="page-section">
        <div class="page-title">
          <h1>Customers</h1>
          <span id="customersSubtitle">Who‚Äôs driving your sales.</span>
        </div>

        <div class="grid-2">
          <div class="card">
            <h2>Customer segments</h2>
            <table id="customersTable">
              <thead>
                <tr>
                  <th>Segment</th>
                  <th>Share of sales</th>
                  <th>Avg. ticket</th>
                </tr>
              </thead>
              <tbody>
                <!-- Filled by JS -->
              </tbody>
            </table>
          </div>

          <div class="card list-card">
            <h2>Customer insights</h2>
            <ul id="customerNotes"></ul>
          </div>
        </div>
      </section>

      <!-- COMPARE SECTION -->
      <section id="section-compare" class="page-section">
        <div class="page-title">
          <h1>Compare periods</h1>
          <span id="compareSubtitle">See how key metrics moved.</span>
        </div>

        <div class="card">
          <h2>Week over week</h2>
          <p class="subtext" id="compareSummary"></p>
          <div class="compare-grid">
            <div class="compare-box">
              <div class="compare-label">This week</div>
              <div class="compare-value" id="compareThisWeek">$0</div>
              <div class="compare-delta" id="compareThisDelta">‚Äì</div>
            </div>
            <div class="compare-box">
              <div class="compare-label">Last week</div>
              <div class="compare-value" id="compareLastWeek">$0</div>
              <div class="subtext" id="compareLastNotes">‚Äì</div>
            </div>
          </div>
        </div>
      </section>

      <!-- NOTIFICATIONS SECTION -->
      <section id="section-notifications" class="page-section">
        <div class="page-title">
          <h1>Notifications</h1>
          <span>What Aervo wants you to pay attention to.</span>
        </div>

        <div id="notificationsList">
          <!-- Filled by JS -->
        </div>
      </section>

      <!-- LOVE FOOTER -->
      <div id="loveFooter" class="love-footer"></div>

    </main>
  </div>

  <script>
    // Backend status checker
    async function checkBackendStatus() {
      const box = document.getElementById('backend-status');
      if (!box) return;

      try {
        const response = await fetch('https://aervo-backend.onrender.com/api/status');
        const data = await response.json();

        box.textContent = `Backend: ${data.status.toUpperCase()} ‚Äî Env: ${data.environment}`;
        box.style.color = '#8fffad';
      } catch (err) {
        box.textContent = 'Backend: OFFLINE';
        box.style.color = '#ff8b8b';
      }
    }

    // Main dashboard logic
    (function () {
      // Auth guard: support both aervo_user and aervoUser
      const rawUser =
        localStorage.getItem("aervo_user") ||
        localStorage.getItem("aervoUser");
        // Show backend status only for Aervo Admin
const backendBox = document.getElementById("backend-status");
if (user?.email === "aervoadmin@aervoapp.com") {
  backendBox.style.display = "block";
}

      if (!rawUser) {
        window.location.href = "login.html";
        return;
      }

      let user;
      try {
        user = JSON.parse(rawUser);
      } catch (e) {
        console.error("Bad user JSON, clearing", e);
        localStorage.removeItem("aervo_user");
        localStorage.removeItem("aervoUser");
        window.location.href = "login.html";
        return;
      }

      const email = (user.email || "").toLowerCase();
      const companyName = user.companyName || "Your business";
      const role = user.role || "Owner";

      // Show email in header
      const userEmailEl = document.getElementById("userEmail");
      if (userEmailEl && user.email) {
        userEmailEl.textContent = user.email;
      }

      // Demo data for known demo accounts
      const demoData = {
        "demo@aervo.com": {
          companyName: "Luna Coffee Co.",
          role: "Owner",
          todayRevenue: "$1,240",
          todayChange: "+12% vs yesterday",
          weekRevenue: "$8,920",
          weekChange: "+7% week over week",
          topProduct: "Iced Vanilla Latte",
          topProductDetail: "142 sold in the last 7 days",
          insights: [
            "Mornings (8‚Äì11am) drive 60% of daily revenue.",
            "Iced drinks outperform hot drinks by 18% this week.",
            "Thursday and Friday are your strongest days."
          ],
          products: [
            { name: "Iced Vanilla Latte", units: 142, revenue: "$712", status: "good" },
            { name: "Cold Brew", units: 98, revenue: "$490", status: "good" },
            { name: "Blueberry Muffin", units: 64, revenue: "$192", status: "warn" },
            { name: "Matcha Latte", units: 37, revenue: "$185", status: "warn" },
            { name: "Bagel w/ Cream Cheese", units: 29, revenue: "$116", status: "bad" }
          ],
          inventoryNotes: [
            "Blueberry Muffin is trending up. Consider a larger batch for Thursday/Friday.",
            "Bagel w/ Cream Cheese has slowed. You may be over-prepping.",
            "Matcha Latte is gaining steady traction with younger customers."
          ],
          trendDays: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
          trendValues: [980, 1120, 1040, 1320, 1480, 1210, 1275],
          trendSummary: "Revenue is strongest on Thu‚ÄìSat, with Friday as your peak day.",
          trendHighlights: [
            "Friday is your best day, driven largely by iced drinks and morning traffic.",
            "Weekends hold steady but don‚Äôt exceed Friday volumes.",
            "Early-week promos could help smooth out Monday/Tuesday dips."
          ],
          compareThisWeek: "$8,920",
          compareThisDelta: "+7% vs last week",
          compareLastWeek: "$8,330",
          compareLastNotes: "Last week was affected by a slower Monday and Tuesday.",
          compareSummary: "You‚Äôre pacing ahead of last week, with stronger performance in the back half of the week.",
          notifications: [
            {
              text: "Iced Vanilla Latte hit a new 7-day high in units sold.",
              time: "2 hours ago"
            },
            {
              text: "Blueberry Muffin is close to selling out for today.",
              time: "4 hours ago"
            },
            {
              text: "Bagel w/ Cream Cheese has underperformed for 3 weeks in a row.",
              time: "Yesterday"
            }
          ],
          customerSegments: [
            { name: "Morning regulars", share: "38%", ticket: "$11.40" },
            { name: "Afternoon students", share: "24%", ticket: "$8.60" },
            { name: "Remote workers", share: "18%", ticket: "$13.20" },
            { name: "Weekend families", share: "20%", ticket: "$15.80" }
          ],
          customerNotes: [
            "Loyalty-style perks for morning regulars could lift frequency.",
            "Students respond well to limited-time cold drink promos.",
            "Remote workers drive higher average tickets when staying longer.",
            "Weekend family bundles (drinks + pastry) could raise order size."
          ]
        },
        "owner@shopdemo.com": {
          companyName: "Skyline Streetwear",
          role: "Owner",
          todayRevenue: "$2,730",
          todayChange: "+5% vs yesterday",
          weekRevenue: "$17,450",
          weekChange: "+11% week over week",
          topProduct: "Midnight Skyline Hoodie",
          topProductDetail: "78 units sold this week",
          insights: [
            "Average order value is up 9% this week.",
            "Hoodies and joggers are driving most of the lift.",
            "Mobile orders account for 63% of sales."
          ],
          products: [
            { name: "Midnight Skyline Hoodie", units: 78, revenue: "$5,460", status: "good" },
            { name: "City Lights Joggers", units: 54, revenue: "$2,160", status: "good" },
            { name: "Neon Cap", units: 41, revenue: "$615", status: "warn" },
            { name: "Oversize Tee ‚Äì Cloud", units: 33, revenue: "$660", status: "warn" },
            { name: "Arch Logo Beanie", units: 18, revenue: "$270", status: "bad" }
          ],
          inventoryNotes: [
            "Midnight Skyline Hoodie is a clear hero. Consider limited-edition colorways.",
            "Neon Cap sells steadily but infrequently in pairs.",
            "Arch Logo Beanie is slow-moving. A small bundle promo could help clear inventory."
          ],
          trendDays: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
          trendValues: [2100, 2350, 2210, 2600, 2950, 2800, 2440],
          trendSummary: "Sales peak on Friday and Saturday with strong mid-week performance.",
          trendHighlights: [
            "Friday remains your biggest revenue day, followed closely by Saturday.",
            "Mid-week drops are small, suggesting consistent demand.",
            "Drops align with weather changes; hoodies spike on cooler days."
          ],
          compareThisWeek: "$17,450",
          compareThisDelta: "+11% vs last week",
          compareLastWeek: "$15,720",
          compareLastNotes: "Last week included one slower promotional day.",
          compareSummary: "You‚Äôre significantly ahead of last week, driven by hoodie and jogger sales.",
          notifications: [
            {
              text: "Midnight Skyline Hoodie is driving 31% of total revenue this week.",
              time: "1 hour ago"
            },
            {
              text: "Arch Logo Beanie appears overstocked based on the last 30 days.",
              time: "Today"
            },
            {
              text: "Cart size increases when Neon Cap is featured in the hero banner.",
              time: "Yesterday"
            }
          ],
          customerSegments: [
            { name: "Urban creatives", share: "42%", ticket: "$86.20" },
            { name: "College students", share: "28%", ticket: "$64.10" },
            { name: "Online drops", share: "18%", ticket: "$112.40" },
            { name: "Tourist traffic", share: "12%", ticket: "$73.50" }
          ],
          customerNotes: [
            "Urban creatives respond strongly to limited drops and collabs.",
            "Students are price-sensitive; bundles and tiered discounts perform well.",
            "Online drop customers buy quickly when inventory looks scarce.",
            "Tourist traffic spikes on weekends and holidays‚Äîgreat time for in-store events."
          ]
        }
      };

      // Generic sample data for real customers
      function buildGenericData(companyName) {
        return {
          companyName,
          role: "Owner",
          todayRevenue: "$1,820",
          todayChange: "+9% vs yesterday",
          weekRevenue: "$12,430",
          weekChange: "+6% week over week",
          topProduct: "Top performer",
          topProductDetail: "Your leading product by revenue this week",
          insights: [
            `${companyName} is trending ahead of last week based on sample data.`,
            "Your top product is responsible for a large share of revenue.",
            "Mid-week performance is solid, with room to grow early in the week."
          ],
          products: [
            { name: "Best seller", units: 120, revenue: "$4,300", status: "good" },
            { name: "Runner up", units: 80, revenue: "$2,150", status: "good" },
            { name: "Steady mover", units: 55, revenue: "$1,050", status: "warn" },
            { name: "New item", units: 26, revenue: "$520", status: "warn" },
            { name: "Slow mover", units: 14, revenue: "$210", status: "bad" }
          ],
          inventoryNotes: [
            "Your best seller looks healthy based on recent sales.",
            "A few slower items might benefit from promos or bundles.",
            "Newer items are starting to gain traction."
          ],
          trendDays: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
          trendValues: [900, 1040, 1180, 1320, 1450, 1230, 1310],
          trendSummary: "Revenue is strongest on Thu‚ÄìSat in this sample view.",
          trendHighlights: [
            "End of week is your strongest window in this sample.",
            "Early-week activity could be improved with targeted campaigns.",
            "Maintaining stock for high-demand days will be important."
          ],
          compareThisWeek: "$12,430",
          compareThisDelta: "+6% vs last week",
          compareLastWeek: "$11,730",
          compareLastNotes: "Last week‚Äôs dip was mainly in the first two days.",
          compareSummary: "You‚Äôre pacing ahead of last week in this sample dashboard.",
          notifications: [
            {
              text: "Your primary product is driving a large share of sample revenue.",
              time: "Today"
            },
            {
              text: "A slow-moving item could be a candidate for a bundle.",
              time: "Yesterday"
            },
            {
              text: "Consider a mid-week promotion to balance out demand.",
              time: "This week"
            }
          ],
          customerSegments: [
            { name: "Loyal repeat buyers", share: "40%", ticket: "$78.20" },
            { name: "New customers", share: "25%", ticket: "$52.10" },
            { name: "Occasional buyers", share: "20%", ticket: "$60.40" },
            { name: "High-value customers", share: "15%", ticket: "$142.70" }
          ],
          customerNotes: [
            "Repeat buyers are your strongest foundation.",
            "New customers may need a clear follow-up touchpoint.",
            "High-value customers respond well to tailored offers.",
            "Occasional buyers could be nudged with gentle reminders."
          ]
        };
      }

      const data = demoData[email] || buildGenericData(companyName);

      // Love footer message
      document.getElementById("loveFooter").textContent =
        `‚ú® Aervo appreciates you, ${data.companyName} ‚ù§Ô∏è`;

      // Fill header
      document.getElementById("companyLabel").textContent =
        data.companyName + " ¬∑ " + (data.role || role);
      document.getElementById("welcomeTitle").textContent =
        "Welcome back, " + data.companyName;

      const now = new Date();
      document.getElementById("dateLabel").textContent =
        now.toLocaleDateString(undefined, { weekday: "long", month: "short", day: "numeric" });

      // Overview metrics
      document.getElementById("todayRevenue").textContent = data.todayRevenue;
      document.getElementById("todayChange").textContent = data.todayChange;
      document.getElementById("weekRevenue").textContent = data.weekRevenue;
      document.getElementById("weekChange").textContent = data.weekChange;
      document.getElementById("topProduct").textContent = data.topProduct;
      document.getElementById("topProductDetail").textContent = data.topProductDetail;

      // Insights
      const insightsList = document.getElementById("insightsList");
      data.insights.forEach(text => {
        const li = document.createElement("li");
        li.textContent = "‚Ä¢ " + text;
        insightsList.appendChild(li);
      });

      // Ask Aervo fake answer
      document.getElementById("askBtn").addEventListener("click", () => {
        const q = document.getElementById("questionInput").value.trim();
        const out = document.getElementById("chatOutput");
        if (!q) {
          out.textContent = "Ask Aervo something about your performance, like ‚ÄúWhat were my top 3 items this week?‚Äù";
          return;
        }
        out.textContent =
          "If this were connected to your real data, Aervo would answer something like:\n\n" +
          "‚ÄúBased on your latest numbers, you're trending " +
          data.todayChange.toLowerCase() +
          " and your top product is " +
          data.topProduct +
          ". This week‚Äôs revenue is " +
          data.weekRevenue +
          " and is " +
          data.weekChange.toLowerCase() +
          ".‚Äù";
      });

      // Products section
      const productsTableBody = document.querySelector("#productsTable tbody");
      data.products.forEach(p => {
        const tr = document.createElement("tr");
        const statusClass =
          p.status === "good" ? "pill-good" :
          p.status === "warn" ? "pill-warn" : "pill-bad";
        const statusText =
          p.status === "good" ? "Healthy" :
          p.status === "warn" ? "Watch" : "At risk";

        tr.innerHTML = `
          <td>${p.name}</td>
          <td>${p.units}</td>
          <td>${p.revenue}</td>
          <td><span class="pill ${statusClass}">${statusText}</span></td>
        `;
        productsTableBody.appendChild(tr);
      });

      const inventoryList = document.getElementById("inventoryNotes");
      data.inventoryNotes.forEach(text => {
        const li = document.createElement("li");
        li.textContent = "‚Ä¢ " + text;
        inventoryList.appendChild(li);
      });

      // Trends section
      document.getElementById("trendSummary").textContent = data.trendSummary;

      const chartBars = document.getElementById("chartBars");
      const chartLabels = document.getElementById("chartLabels");
      const maxVal = Math.max(...data.trendValues);

      data.trendValues.forEach((val, idx) => {
        const heightPercent = (val / maxVal) * 100;

        const bar = document.createElement("div");
        bar.className = "chart-bar";
        bar.style.height = heightPercent + "%";
        bar.innerHTML = `<span>${val.toLocaleString()}</span>`;
        chartBars.appendChild(bar);

        const label = document.createElement("div");
        label.textContent = data.trendDays[idx];
        chartLabels.appendChild(label);
      });

      const trendHighlights = document.getElementById("trendHighlights");
      data.trendHighlights.forEach(text => {
        const li = document.createElement("li");
        li.textContent = "‚Ä¢ " + text;
        trendHighlights.appendChild(li);
      });

      // Customers section
      const customersTableBody = document.querySelector("#customersTable tbody");
      data.customerSegments.forEach(seg => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${seg.name}</td>
          <td>${seg.share}</td>
          <td>${seg.ticket}</td>
        `;
        customersTableBody.appendChild(tr);
      });

      const customerNotesList = document.getElementById("customerNotes");
      data.customerNotes.forEach(text => {
        const li = document.createElement("li");
        li.textContent = "‚Ä¢ " + text;
        customerNotesList.appendChild(li);
      });

      // Compare section
      document.getElementById("compareThisWeek").textContent = data.compareThisWeek;
      document.getElementById("compareThisDelta").textContent = data.compareThisDelta;
      document.getElementById("compareLastWeek").textContent = data.compareLastWeek;
      document.getElementById("compareLastNotes").textContent = data.compareLastNotes;
      document.getElementById("compareSummary").textContent = data.compareSummary;

      // Notifications section
      const notificationsList = document.getElementById("notificationsList");
      data.notifications.forEach(n => {
        const div = document.createElement("div");
        div.className = "notification";
        div.innerHTML = `
          <div>${n.text}</div>
          <small>${n.time}</small>
        `;
        notificationsList.appendChild(div);
      });

      // Sidebar navigation logic
      const navItems = document.querySelectorAll(".nav-item");
      const sections = {
        overview: document.getElementById("section-overview"),
        products: document.getElementById("section-products"),
        trends: document.getElementById("section-trends"),
        customers: document.getElementById("section-customers"),
        compare: document.getElementById("section-compare"),
        notifications: document.getElementById("section-notifications")
      };

      navItems.forEach(item => {
        item.addEventListener("click", () => {
          const sectionName = item.getAttribute("data-section");

          // Active state on sidebar
          navItems.forEach(n => n.classList.remove("active"));
          item.classList.add("active");

          // Show matching section
          Object.keys(sections).forEach(key => {
            sections[key].classList.remove("active");
          });
          sections[sectionName].classList.add("active");
        });
      });

      // Logout
      document.getElementById("logoutBtn").addEventListener("click", () => {
        localStorage.removeItem("aervo_token");
        localStorage.removeItem("aervo_user");
        localStorage.removeItem("aervoUser");
        window.location.href = "login.html";
      });

      // Start backend status checks
      checkBackendStatus();
      setInterval(checkBackendStatus, 5000);
    })();
  </script>
</body>
</html>